---
import CommunityOrganizationsTreeVue from './CommunityOrganizationsTree._vue';
import { circularReplacer } from '@/utils/jsonReplacer';

const organizations = await allCommunityOrganizations();
const roots = getOrganizationRoots(organizations);

const data = {
	tree: roots[0],
	keys: organizations.map((d) => d.id).sort(),
};

const dataJSON = JSON.stringify(data, circularReplacer());

import { getLangFromUrl } from '@/i18n/utils';
import { allCommunityOrganizations, getOrganizationRoots } from '@/utils/content.organizations';

const lang = getLangFromUrl(Astro.url);
---

<CommunityOrganizationsTreeVue client:only="true" dataJSON={dataJSON} />
