---
import CommunityOrganizationsTreeVue from './CommunityOrganizationsTree.vue';
import { circularReplacer } from '@/utils/jsonReplacer';

let { rootId = '/' } = Astro.props;

const root = await getCommunityOrganizationsRoot(rootId);

const data = {
  tree: root,
  keys: root
    .descendants()
    .map((t) => t.data.id)
    .sort()
};

const dataJSON = JSON.stringify(data, circularReplacer());

import { getLangFromUrl } from '@/i18n/utils';

const lang = getLangFromUrl(Astro.url);
---

<CommunityOrganizationsTreeVue client:only="true" dataJSON={dataJSON} />
