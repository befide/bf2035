---
import StarlightPage from '@astrojs/starlight/components/StarlightPage.astro';

import { getCommunityTopLevelOrganizations } from '@/utils';
import ProfileOrganizationTreeTable from '@/components/domain/ProfileOrganizationTreeTable.astro';
import ProfileFacilityTreeTable from '@/components/domain/ProfileFacilityTreeTable.astro';
import ProfileCourses from '@/components/domain/ProfileCourses.astro';
import ProfileTheses from '@/components/domain/ProfileTheses.astro';

export async function getStaticPaths() {
  return (await getCommunityTopLevelOrganizations()).map((organization) => ({
    params: { id: organization.id },
    props: { organization }
  }));
}

const { organization } = Astro.props;
---

<StarlightPage frontmatter={{ title: organization.label.fullName.en }}>
  <h2>Working Groups</h2>

  <ProfileOrganizationTreeTable rootId={organization.id} />

  <h2>Facilities</h2>

  <h3>User Facilities</h3>

  <ProfileFacilityTreeTable hostId={organization.id} />

  <h3>Test Facilities</h3>

  <ProfileFacilityTreeTable hostId={organization.id} />

  <h2>Courses</h2>

  <ProfileCourses universityId={organization.id} />

  <h2>Doctoral Theses</h2>

  <ProfileTheses universityId={organization.id} />
</StarlightPage>
